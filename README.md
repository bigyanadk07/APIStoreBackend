# API Documentation

## Auth APIs (/auth) Testing Complete)

### 1. Send OTP for Login
- **Endpoint:** `POST /auth/login`
- **Headers:** None
- **Payload:**
  ```json
  {
    "phone": "+97798xxxxxxxx"
  }
  ```
- **Description:** Sends an OTP to the given email or phone number for login.
- **Testing Tip:** Use a valid email or phone to receive the OTP.

### 2. Verify OTP and Generate Token
- **Endpoint:** `POST /auth/verify-otp`
- **Headers:** None
- **Payload:**
  ```json
  {
    "phone": "+97798xxxxxxxx",
    "code": "string"
  }
  ```
- **Description:** Verifies the OTP and returns an auth token for the user.
- **Testing Tip:** Use the OTP received from the `/auth/login` endpoint.

### 3. Register New User
- **Endpoint:** `POST /auth/register`
- **Headers:** None
- **Payload:**
  ```json
  {
    "name": "string",
    "email": "string",
    "phone": "string"
  }
  ```
- **Description:** Registers a new user.
- **Testing Tip:** Provide at least one (email or phone) along with the name.

### 4. Get Current User Profile
- **Endpoint:** `GET /auth/me`
- **Headers:** 
  - Authorization: Bearer `<auth_token>`
- **Payload:** None
- **Description:** Fetches the authenticated user's profile.
- **Testing Tip:** After verifying OTP, use the received token here.

## Package APIs (/packages)  (Testing Complete)

### 5. Get All Packages
- **Endpoint:** `GET /packages`
- **Headers:** None
- **Payload:** None
- **Description:** Fetches all available packages.

### 6. Get Package by ID
- **Endpoint:** `GET /packages/:id`
- **Headers:** None
- **Payload:** None (ID passed in URL param)
- **Description:** Fetches a single package by its ID.
- **Testing Tip:** Replace `:id` with the actual package ID.

### 7. Subscribe to a Package
- **Endpoint:** `POST /packages/subscribe`
- **Headers:**
  - Authorization: Bearer `<auth_token>`
- **Payload:**
  ```json
  {
    "packageId": "string",
    "paymentDetails": {
          "method": "Khalti",
          "transactionId": "KLT123456789",
          "amount": 500,
          "currency": "NPR"
  }
    }
  ```
- **Description:** Subscribes the authenticated user to a package.
- **Testing Tip:** Make sure you have a valid packageId and simulate a paymentDetails object.

### 8. Get User's Subscriptions
- **Endpoint:** `GET /packages/user/subscriptions`
- **Headers:**
  - Authorization: Bearer `<auth_token>`
- **Payload:** None
- **Description:** Fetches all subscriptions for the logged-in user.

## API Management (/apis) (Testing Complete)

### 9. Get All Available APIs
- **Endpoint:** `GET /apis`
- **Headers:** None
- **Payload:** None
- **Description:** Lists all the available APIs.

### 10. Get API by ID
- **Endpoint:** `GET /apis/:id`
- **Headers:** None
- **Payload:** None (ID passed in URL param)
- **Description:** Fetches details of a specific API.
- **Testing Tip:** Replace `:id` with the actual API ID.

### 11. Get User's API Keys
- **Endpoint:** `GET /apis/keys`
- **Headers:**
  - Authorization: Bearer `<auth_token>`
- **Payload:** None
- **Description:** Fetches all API keys generated by the user.

### 12. Generate New API Key
- **Endpoint:** `POST /apis/keys`
- **Headers:**
  - Authorization: Bearer `<auth_token>`
- **Payload:**
  ```json
  {
    "apiId": "string"
  }
  ```
- **Description:** Creates a new API key for a specific API.

### 13. Revoke API Key
- **Endpoint:** `DELETE /apis/keys/:keyId`
- **Headers:**
  - Authorization: Bearer `<auth_token>`
- **Payload:** None (keyId passed in URL param)
- **Description:** Deletes/revokes a user's API key.
- **Testing Tip:** Replace `:keyId` with the key you want to revoke.

## Usage Statistics (/usage) (Testing Incomplete)

### 14. Get Usage Statistics
- **Endpoint:** `GET /usage/stats`
- **Headers:**
  - Authorization: Bearer `<auth_token>`
- **Query Parameters:**
  - from (date, required) — start date
  - to (date, required) — end date
  - apiId (string, optional) — filter by API ID
- **Example URL:** `GET /usage/stats?from=2024-04-01&to=2024-04-27`
- **Description:** Retrieves usage data for user's API keys within a specified date range.
- **Testing Tip:** Ensure correct date format (YYYY-MM-DD).
